<!DOCTYPE html>
<html lang="en">
<head>
<!--  2024-06-18 Tue 23:44  -->
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1" name="viewport" />
<title>‎</title>
<meta content="Vindaar" name="author" />
<meta content="Org Mode" name="generator" />

<link type="text/css" rel="stylesheet" href="org_html_export.css" />
<script type="text/javascript">

document.addEventListener('DOMContentLoaded', function() {
    // Set the initial width for subfigures and their images
    document.querySelectorAll('figure.subfigure[data-width]').forEach(function(subfigure) {
        subfigure.style.width = subfigure.getAttribute('data-width');
    });

    document.querySelectorAll('figure.subfigure img[data-width]').forEach(function(img) {
        img.style.width = img.getAttribute('data-width');
    });

    // Event listener for images within subfigures
    document.querySelectorAll('figure.subfigure img[data-width]').forEach(function(img) {
        img.addEventListener('click', function() {
            // Determine the .figure-wrapper that contains the clicked image
            let wrapper = this.closest('.figure-wrapper');

            // If found, adjust the sizes of its subfigures
            if (wrapper) {
                let subfigures = wrapper.querySelectorAll('figure.subfigure');
                subfigures.forEach(subfigure => {
                    let width = parseFloat(subfigure.getAttribute('data-width'));
                    if (width < 50) { // Double size if less than 50%
                        subfigure.setAttribute('data-width', (width * 2) + '%');
                        subfigure.style.width = (width * 2) + '%';
                    } else { // Halve size otherwise
                        subfigure.setAttribute('data-width', (width / 2) + '%');
                        subfigure.style.width = (width / 2) + '%';
                    }
                });
            }
        });
    });
});

document.addEventListener('DOMContentLoaded', function () {
    var headers = document.querySelectorAll('h1 .extended, h2 .extended, h3 .extended, h4 .extended, h5 .extended, h6 .extended');

    headers.forEach(function (header) {
        var foldableHeader = header.closest('h1, h2, h3, h4, h5, h6');
        if (foldableHeader) {
            foldableHeader.classList.add('foldable-header');
            var nextElement = foldableHeader.nextElementSibling;
            var contentToFold = [];
            while (nextElement && !nextElement.matches('h1, h2, h3, h4, h5, h6')) {
                contentToFold.push(nextElement);
                nextElement = nextElement.nextElementSibling;
            }
            contentToFold.forEach(function (element) {
                element.classList.add('folded-content');
            });

            foldableHeader.addEventListener('click', function () {
                contentToFold.forEach(function (element) {
                    if (element.style.display === 'none' || element.style.display == '') {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                });
            });
        }
    });
});

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script type="text/x-mathjax-config">
<!-- /* --><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js", "[Contrib]/siunitx/siunitx.js", "[Contrib]/mhchem/mhchem.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"], ['$', '$'], ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 1.0,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        },
        TeX: {
              equationNumbers: { autoNumber: 'AMS' },
              Macros: {
                  ccsini: '{\\mathrm{Si}₃\\mathrm{N}₄}',
                  cefe: '{\\ce{^{55}Fe}}',
                  vektor: ['{\\begin{pmatrix}#1\\end{pmatrix}}', 1],
                  mtrix: ['{\\begin{pmatrix}#1\\end{pmatrix}}', 1],
                  cp: '{\\mathrm{CP}}',
                  cpt: '{\\mathrm{CPT}}',
                  dd: '{\\mathop{}\\!{\\mathrm{d}}}',
                  sinc: '{\\mathrm{sinc}}'
              }
        }
    });
/*]]>*///--&gt;
</script>
</head>
<body>
<div id="content" class="content">
<nav role="doc-toc" id="table-of-contents">
<h2>Table of Contents</h2>
<div role="doc-toc" id="text-table-of-contents">
<ul>
<li>  <a href="./errata.html#sec:errata">1. Errata   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./introduction.html#sec:introduction">2. Introduction   <span class="tag">    <span class="Intro">Intro</span>  </span></a></li>
<li><a href="./about_thesis.html#sec:about_thesis">3. About this thesis   <span class="tag">  <span class="Intro">Intro</span></span></a>
<ul>
<li>  <a href="./about_thesis.html#orgc36e3ba">3.1. Extended notes for the extended thesis <code>[/]</code>   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./about_thesis.html#org976c329">3.2. Why Org mode   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./about_thesis.html#orga7aaacb">3.3. Notes for future PhD students and IAXO analyses   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./theory.html#sec:theory">4. Theory of axions   <span class="tag">  <span class="Theory">Theory</span></span></a>
<ul>
<li>  <a href="./theory.html#sec:theory:useful_reading_material">4.1. Useful reading material   <span class="tag">    <span class="optional">optional</span>  </span></a></li>
<li>  <a href="./theory.html#sec:theory:illustration_cpt">4.2. Illustration of the \cpt symmetry <code>[/]</code>   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./theory.html#sec:theory:invisible_axion_models">4.3. Invisible axion models and axion couplings</a></li>
<li>  <a href="./theory.html#sec:theory:axion_interactions">4.4. Implications for axion interactions - conversion probability</a></li>
<li>  <a href="./theory.html#sec:theory:solar_axion_flux">4.5. Solar axion flux</a></li>
<li>  <a href="./theory.html#sec:theory:chameleon">4.6. Chameleons</a></li>
<li>  <a href="./theory.html#sec:theory:current_bounds">4.7. Current bounds on coupling constants</a></li>
</ul>
</li>
<li><a href="./helioscopes.html#sec:helioscopes">5. Axion helioscopes   <span class="tag">  <span class="Theory">Theory</span></span></a>
<ul>
<li>  <a href="./helioscopes.html#sec:helioscopes:cast">5.1. CERN Axion Solar Telescope (CAST)</a></li>
<li>  <a href="./helioscopes.html#sec:helioscopes:iaxo">5.2. International AXion Observatory (IAXO)</a></li>
</ul>
</li>
<li><a href="./theory_detector.html#sec:theory_detector">6. X-rays, cosmic muons and gaseous detectors   <span class="tag">  <span class="Theory">Theory</span></span></a>
<ul>
<li>  <a href="./theory_detector.html#sec:theory:particle_int">6.1. Particle interactions with matter</a></li>
<li>  <a href="./theory_detector.html#sec:theory:cosmic_radiation">6.2. Cosmic rays</a></li>
<li>  <a href="./theory_detector.html#sec:theory:gas_fundamentals">6.3. Gaseous detector fundamentals</a></li>
</ul>
</li>
<li><a href="./septemboard.html#sec:septemboard">7. Septemboard detector   <span class="tag">  <span class="Detector">Detector</span></span></a>
<ul>
<li>  <a href="./septemboard.html#sec:detector:micromegas">7.1. Micromegas working principle</a></li>
<li>  <a href="./septemboard.html#sec:detector:timepix">7.2. Timepix ASIC</a></li>
<li>  <a href="./septemboard.html#sec:detector:gridpix">7.3. GridPix</a></li>
<li>  <a href="./septemboard.html#sec:detector:detector_2014_15">7.4. 2014 / 2015 GridPix detector for CAST</a></li>
<li>  <a href="./septemboard.html#sec:detector:detector_overview">7.5. Septemboard detector overview</a></li>
<li>  <a href="./septemboard.html#orgc654d28">7.6. Detector readout system</a></li>
<li>  <a href="./septemboard.html#sec:detector:scintillators">7.7. Scintillator vetoes</a></li>
<li>  <a href="./septemboard.html#sec:detector:fadc">7.8. FADC</a></li>
<li>  <a href="./septemboard.html#sec:detector:sin_window">7.9. SiN window</a></li>
<li>  <a href="./septemboard.html#sec:detector:septemboard">7.10. Septemboard - 6 GridPixes around a center one</a></li>
<li>  <a href="./septemboard.html#sec:detector:water_cooling">7.11. Water cooling and temperature readout for the septemboard</a></li>
<li>  <a href="./septemboard.html#sec:septem:efficiency">7.12. Detector efficiency</a></li>
<li>  <a href="./septemboard.html#sec:detector:daq">7.13. Data acquisition and detector monitoring</a></li>
</ul>
</li>
<li><a href="./operation_calibration.html#sec:operation_calibration">8. Detector calibration for operation   <span class="tag">  <span class="Detector">Detector</span></span></a>
<ul>
<li>  <a href="./operation_calibration.html#sec:operation_calibration:timepix">8.1. Timepix calibrations</a></li>
<li>  <a href="./operation_calibration.html#sec:operation_calibration:fadc">8.2. FADC calibration</a></li>
<li>  <a href="./operation_calibration.html#sec:operation_calibration:scintillators">8.3. Scintillator calibration</a></li>
</ul>
</li>
<li><a href="./reconstruction.html#sec:reconstruction">9. Data reconstruction   <span class="tag">  <span class="Reconstruction">Reconstruction</span></span></a>
<ul>
<li>  <a href="./reconstruction.html#sec:reco:tpa">9.1. <code>TimepixAnalysis</code> and Nim</a></li>
<li>  <a href="./reconstruction.html#sec:reco:tos_data_parsing">9.2. TOS data parsing</a></li>
<li>  <a href="./reconstruction.html#sec:reco:event_shape">9.3. Expectation of event shapes</a></li>
<li>  <a href="./reconstruction.html#sec:reco:data_reconstruction">9.4. Data reconstruction</a></li>
<li>  <a href="./reconstruction.html#sec:reco:fadc_data">9.5. FADC reconstruction</a></li>
<li>  <a href="./reconstruction.html#sec:reco:scintillator_data">9.6. Scintillator data</a></li>
</ul>
</li>
<li><a href="./cast.html#sec:cast">10. Detector installation &amp; data taking at CAST   <span class="tag">  <span class="CAST">CAST</span></span></a>
<ul>
<li>  <a href="./cast.html#sec:cast:timeline">10.1. Timeline</a></li>
<li>  <a href="./cast.html#sec:cast:alignment">10.2. Alignment</a></li>
<li>  <a href="./cast.html#sec:cast:detector_setup">10.3. Detector setup at CAST</a></li>
<li>  <a href="./cast.html#sec:cast:window_accident">10.4. Window accident</a></li>
<li>  <a href="./cast.html#sec:cast:data_taking_woes">10.5. Data taking woes</a></li>
<li>  <a href="./cast.html#sec:cast:data_taking_campaigns">10.6. Summary of CAST data taking</a></li>
</ul>
</li>
<li><a href="./calibration.html#sec:calibration">11. Data calibration   <span class="tag">  <span class="Calibration">Calibration</span></span></a>
<ul>
<li>  <a href="./calibration.html#sec:calibration:energy">11.1. Energy calibration - in principle</a></li>
<li>  <a href="./calibration.html#sec:calib:detector_behavior_over_time">11.2. Detector behavior over time</a></li>
<li>  <a href="./calibration.html#sec:calib:final_energy_calibration">11.3. Energy calibration dependence on the gas gain</a></li>
<li>  <a href="./calibration.html#sec:calib:fadc">11.4. FADC</a></li>
</ul>
</li>
<li><a href="./background.html#sec:background">12. Finding signal and defining background | Background rate computation   <span class="tag">  <span class="Analysis">Analysis</span></span></a>
<ul>
<li>  <a href="./background.html#sec:background:likelihood_method">12.1. Likelihood method</a></li>
<li>  <a href="./background.html#sec:cdl">12.2. CAST Detector Lab</a></li>
<li>  <a href="./background.html#sec:background:likelihood_cut">12.3. Application of likelihood cut for background rate</a></li>
<li>  <a href="./background.html#sec:background:mlp">12.4. Artificial neural networks as cluster classifiers</a></li>
<li>  <a href="./background.html#sec:background:additional_vetoes">12.5. Additional detector features as vetoes</a></li>
<li>  <a href="./background.html#sec:background:all_vetoes_combined">12.6. Background rates of combined vetoes and efficiencies</a></li>
</ul>
</li>
<li><a href="./limit.html#sec:limit">13. Limit calculation   <span class="tag">  <span class="Limit">Limit</span></span></a>
<ul>
<li>  <a href="./limit.html#sec:limit:method_introduction">13.1. Limit method - introduction</a></li>
<li>  <a href="./limit.html#sec:limit:method_likelihood">13.2. Limit method - likelihood function \(\mathcal{L}\)</a></li>
<li>  <a href="./limit.html#sec:limit:method_computing_L">13.3. Limit method - computing \(\mathcal{L}\)</a></li>
<li>  <a href="./limit.html#sec:limit:method_computing_a_limit">13.4. Limit method - computing a limit</a></li>
<li>  <a href="./limit.html#sec:limit:method_expected_limit">13.5. Limit method - toy candidate sets and expected limits</a></li>
<li>  <a href="./limit.html#sec:limit:method_systematics">13.6. Limit method - extending \(\mathcal{L}\) for systematics</a></li>
<li>  <a href="./limit.html#sec:limit:method_mcmc">13.7. Limit method - evaluating \(\mathcal{L}\) with nuisance parameters</a></li>
<li>  <a href="./limit.html#org5e81b6c">13.8. Note about likelihood integral   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./limit.html#orge06cfa1">13.9. Derivation of short form of \(\mathcal{L}\) <code>[/]</code>   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./limit.html#sec:limit:ingredients">13.10. Likelihood ingredients in detail</a></li>
<li>  <a href="./limit.html#sec:limit:systematics">13.11. Systematics</a></li>
<li>  <a href="./limit.html#sec:limit:mcmc_calc_limit">13.12. MCMC to sample the distribution and compute a limit</a></li>
<li>  <a href="./limit.html#sec:limit:expected_limits">13.13. Expected limits of different setups</a></li>
<li>  <a href="./limit.html#sec:limit:candidates">13.14. Solar tracking candidates</a></li>
<li>  <a href="./limit.html#sec:limit:observed_limit">13.15. Observed limit - \(g_{ae}\)</a></li>
<li>  <a href="./limit.html#sec:limit:other_couplings">13.16. Other coupling constants</a></li>
<li>  <a href="./limit.html#orgc627f43">13.17. Comparison to 2013 limit (using their method)   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./limit.html#orgda19ced">13.18. Observed limit for different axion masses   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li>  <a href="./outlook.html#sec:outlook">14. Outlook</a></li>
<li>  <a href="./summary.html#sec:summary">15. Summary &amp; conclusion</a></li>
<li>  <a href="./bibliography.html#sec:bibliography">16. Bibliography   <span class="tag">    <span class="html">html</span>  </span></a></li>
<li><a href="./daq.html#sec:daq">17. Data acquisition and detector monitoring   <span class="tag"><span class="Appendix">Appendix</span> <span class="Detector">Detector</span></span></a>
<ul>
<li>  <a href="./daq.html#sec:daq:tof">17.1. Timepix Operating Firmware - TOF</a></li>
<li>  <a href="./daq.html#sec:daq:tos">17.2. Timepix Operating Software - TOS</a></li>
<li>  <a href="./daq.html#sec:daq:septemboard_event_display">17.3. Septemboard event display</a></li>
</ul>
</li>
<li><a href="./configuration.html#sec:appendix:configuration">18. Configuration and TOS / TOF versions   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./configuration.html#sec:appendix:configuration:tos_config">18.1. TOS configuration file</a></li>
<li>  <a href="./configuration.html#sec:appendix:configuration:tos_tof_versions">18.2. TOS and TOF versions used at CAST</a></li>
</ul>
</li>
<li><a href="./calibration.html#sec:appendix:calibration">19. Calibrations   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./calibration.html#sec:appendix:calibration:timepix">19.1. Timepix calibrations</a></li>
<li>  <a href="./calibration.html#sec:appendix:septemboard_calibrations">19.2. Septemboard calibration</a></li>
<li>  <a href="./calibration.html#sec:appendix:scintillator_calibration_notes">19.3. Calibration measurements of the veto scintillator paddle   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./cast_operations.html#sec:appendix:cast_operations">20. CAST operation procedures   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./cast_operations.html#sec:appendix:cast_operations:terminology">20.1. CAST terminology</a></li>
<li>  <a href="./cast_operations.html#sec:cast:high_voltage">20.2. High voltage supply</a></li>
<li>  <a href="./cast_operations.html#sec:cast:vacuum_system">20.3. Vacuum system</a></li>
<li>  <a href="./cast_operations.html#sec:cast:watercooling_gas">20.4. Watercooling system &amp; gas supply</a></li>
<li>  <a href="./cast_operations.html#sec:cast:interlock_systems">20.5. Interlock systems</a></li>
<li>  <a href="./cast_operations.html#sec:appendix:cast_log_files">20.6. CAST log files</a></li>
</ul>
</li>
<li><a href="./cast_run_list.html#sec:appendix:cast_run_list">21. CAST data taking run list   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./cast_run_list.html#orgd304089">21.1. Full version   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./cast_data_taking_notes.html#sec:appendix:cast_data_taking_notes">22. CAST data taking notes <code>[0/1]</code>   <span class="tag"><span class="Appendix">Appendix</span> <span class="extended">extended</span></span></a>
<ul>
<li>  <a href="./cast_data_taking_notes.html#orge4011be">22.1. Run table</a></li>
<li>  <a href="./cast_data_taking_notes.html#orgeba5174">22.2. Data runs</a></li>
<li>  <a href="./cast_data_taking_notes.html#orgd62eab2">22.3. Calibration runs</a></li>
<li>  <a href="./cast_data_taking_notes.html#org0271f47">22.4. Automatically generated run list</a></li>
<li>  <a href="./cast_data_taking_notes.html#orgb34c028">22.5. Automatically calculated total run times</a></li>
<li>  <a href="./cast_data_taking_notes.html#org338e161">22.6. InGrid temperature from shift forms</a></li>
</ul>
</li>
<li><a href="./cabling_and_softwar_setup.html#sec:appendix:cabling_and_softwar_setup">23. Cabling &amp; software setup <code>[/]</code>   <span class="tag"><span class="Appendix">Appendix</span> <span class="extended">extended</span></span></a>
<ul>
<li>  <a href="./cabling_and_softwar_setup.html#org7cb11ec">23.1. Virtex V6 cabling</a></li>
<li>  <a href="./cabling_and_softwar_setup.html#org3244c1a">23.2. Detector cabling</a></li>
<li>  <a href="./cabling_and_softwar_setup.html#org7c3b445">23.3. Vivado / ISE on void linux &amp; flashing Virtex V6</a></li>
<li>  <a href="./cabling_and_softwar_setup.html#orgda4f123">23.4. Setting up the chips in TOS</a></li>
</ul>
</li>
<li><a href="./vacuum_contamination.html#sec:appendix:vacuum_contamination">24. Window rupture and vacuum contamination   <span class="tag"><span class="Appendix">Appendix</span> <span class="extended">extended</span></span></a>
<ul>
<li>  <a href="./vacuum_contamination.html#org35e49a4">24.1. Calculation of vacuum volume</a></li>
<li>  <a href="./vacuum_contamination.html#orgdf125cb">24.2. Calculation of potential influx of gas</a></li>
<li>  <a href="./vacuum_contamination.html#orgf5a7285">24.3. Consider pumping of pumps</a></li>
<li>  <a href="./vacuum_contamination.html#orgeeae0bd">24.4. Calculation of possible contamination</a></li>
</ul>
</li>
<li><a href="./detector_time_behavior.html#sec:appendix:detector_time_behavior">25. Detector behavior over time   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./detector_time_behavior.html#sec:appendix:choice_gas_gain_binning">25.1. Choice of gas gain binning time interval</a></li>
<li>  <a href="./detector_time_behavior.html#sec:appendix:correlation_gas_gain_ambient_temp">25.2. Correlation of gas gain and ambient CAST temperature</a></li>
</ul>
</li>
<li><a href="./cast_detector_lab.html#sec:appendix:cast_detector_lab">26. CAST Detector Lab data   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./cast_detector_lab.html#orgfed071e">26.1. Generate all spectrum plots split by run   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./cast_detector_lab.html#sec:appendix:cdl_spectra_by_run">26.2. All spectra split by run</a></li>
<li>  <a href="./cast_detector_lab.html#sec:appendix:cdl:all_spectra_fits">26.3. All CDL spectra with line fits   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./cast_detector_lab.html#sec:appendix:cdl:all_spectra_fits_by_run">26.4. All CDL spectra with line fits by run</a></li>
</ul>
</li>
<li><a href="./fit_by_run_justification.html#sec:appendix:fit_by_run_justification">27. CAST Detector Lab variations and fitting by run   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./fit_by_run_justification.html#sec:appendix:fit_by_run:gas_gain_var_cluster_prop">27.1. Influence of gas gain variations on cluster properties</a></li>
</ul>
</li>
<li><a href="./morphing_cdl_spectra.html#sec:appendix:morphing_cdl_spectra">28. Morphing of CDL reference spectra   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./morphing_cdl_spectra.html#orgabd5f0e">28.1. Generate all morphing / tile related plots   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./morphing_cdl_spectra.html#orga5d9c5b">28.2. Generate plot comparing likelihood behavior   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./morphing_cdl_spectra.html#sec:appendix:morphing_cdl_spectra:tilemaps">28.3. Tilemap of each likelihood dataset</a></li>
<li>  <a href="./morphing_cdl_spectra.html#sec:appendix:morphing_cdl_spectra:interpolation_raster">28.4. Interpolation of each likelihood dataset</a></li>
<li>  <a href="./morphing_cdl_spectra.html#sec:appendix:morphing_cdl_spectra:binwise_linear">28.5. Binwise linear interpolations for each likelihood dataset</a></li>
<li>  <a href="./morphing_cdl_spectra.html#org218c56a">28.6. Notes on CDL morphing development   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./occupancy.html#sec:appendix:occupancy">29. Occupancy maps   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./occupancy.html#orgdce408e">29.1. Run-2</a></li>
<li>  <a href="./occupancy.html#orge5d3863">29.2. Run-3</a></li>
<li>  <a href="./occupancy.html#org971382a">29.3. Generate occupancy map plots   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./fadc.html#sec:appendix:fadc">30. FADC   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./fadc.html#sec:appendix:fadc:rise_fall">30.1. FADC rise and fall time</a></li>
<li>  <a href="./fadc.html#sec:appendix:background:fadc">30.2. FADC veto</a></li>
<li>  <a href="./fadc.html#org517ef50">30.3. Generate plot of rise time vs skewness   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./fadc.html#sec:appendix:fadc_veto_empirical_cluster_length">30.4. Expected cluster size</a></li>
</ul>
</li>
<li><a href="./background_rates.html#sec:appendix:background_rates">31. Raw data and background rates   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./background_rates.html#sec:appendix:background_rates:full_chip">31.1. Background rates over full chip</a></li>
<li>  <a href="./background_rates.html#org01e8b4b">31.2. Generate rate without any vetoes over full chip   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./background_rates.html#org2774ce8">31.3. Generate background rates over full chip   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./background_rates.html#orgd0f5dfb">31.4. Generate table of background rates for all setups   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li>  <a href="./background_interpolation_chip_area.html#sec:appendix:background_interpolation_chip_area">32. Background interpolation chip cutout correction   <span class="tag">    <span class="Appendix">Appendix</span>  </span></a></li>
<li><a href="./limit_additional.html#sec:appendix:limit_additional">33. Additional limit information   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./limit_additional.html#sec:appendix:conversion_probability">33.1. Conversion probability as a function of mass   <span class="tag">    <span class="Appendix">Appendix</span>  </span></a></li>
<li>  <a href="./limit_additional.html#sec:appendix:exp_limit_percentiles">33.2. Expected limit table with percentiles</a></li>
<li>  <a href="./limit_additional.html#sec:appendix:limit_additional:axion_photon">33.3. Observed limit - axion photon \(g_{aγ}\)</a></li>
<li>  <a href="./limit_additional.html#sec:appendix:limit_additional:chameleon">33.4. Observed limit - chameleon \(β_γ\)</a></li>
</ul>
</li>
<li><a href="./software.html#sec:appendix:software">34. Software   <span class="tag"><span class="Software">Software</span> <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./software.html#orgbae2c69">34.1. Why did I start writing my own analysis framework?   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./software.html#org13d471b">34.2. Nim   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./software.html#sec:appendix:timepix_analysis">34.3. TimepixAnalysis</a></li>
<li>  <a href="./software.html#orgb88ee40">34.4. Other libraries relevant for TimepixAnalysis</a></li>
</ul>
</li>
<li><a href="./full_data_reconstruction.html#sec:appendix:full_data_reconstruction">35. Full data reconstruction   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./full_data_reconstruction.html#org39ad6bd">35.1. Raw data parsing and reconstruction</a></li>
<li>  <a href="./full_data_reconstruction.html#org1eac87c">35.2. Parse and reconstruct the CDL data</a></li>
<li>  <a href="./full_data_reconstruction.html#org09b2461">35.3. Add tracking information to background files</a></li>
<li>  <a href="./full_data_reconstruction.html#org3344338">35.4. Using <code>runAnalysisChain</code></a></li>
<li>  <a href="./full_data_reconstruction.html#org18a2de7">35.5. Applying a classifier</a></li>
<li>  <a href="./full_data_reconstruction.html#org17bde80">35.6. Computing limits</a></li>
</ul>
</li>
<li><a href="./average_depth_xrays_argon.html#sec:appendix:average_depth_xrays_argon">36. Average distance X-rays travel in argon at CAST conditions   <span class="tag">  <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./average_depth_xrays_argon.html#org2d84fd5">36.1. Reference to original document   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./average_depth_xrays_argon.html#org11eec4e">36.2. Calculate conversion point numerically</a></li>
<li>  <a href="./average_depth_xrays_argon.html#org28b81a5">36.3. Compiling and running the code   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li><a href="./raytracing.html#sec:appendix:raytracing">37. Raytracing   <span class="tag"><span class="Software">Software</span> <span class="Appendix">Appendix</span></span></a>
<ul>
<li>  <a href="./raytracing.html#sec:appendix:raytracing:traxer">37.1. TrAXer - An interactive axion raytracer</a></li>
<li>  <a href="./raytracing.html#sec:appendix:raytracing:llnl_telescope">37.2. A few more details about the LLNL telescope</a></li>
<li>  <a href="./raytracing.html#sec:appendix:raytracing:panter">37.3. Comparison of TrAXer results with PANTER measurements</a></li>
<li>  <a href="./raytracing.html#sec:appendix:raytracing:axion_image">37.4. Computing an axion image with TrAXer</a></li>
<li>  <a href="./raytracing.html#org7d687b6">37.5. Reproducing an X-ray finger run with TrAXer   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
<li>  <a href="./raytracing.html#orgc4745d9">37.6. Figure error development notes   <span class="tag">    <span class="extended">extended</span>  </span></a></li>
</ul>
</li>
<li>  <a href="./acknowledgments.html#sec:appendix:acknowledgments">38. Acknowledgments   <span class="tag">    <span class="Part5">Part5</span>  </span></a></li>
</ul>
</div>
</nav>
<div class="outline-2" id="outline-container-sec:appendix:fadc">
<h2 id="sec:appendix:fadc"><span class="section-number-2">30.</span> FADC   <span class="tag">  <span class="Appendix">Appendix</span></span></h2>
<div class="outline-text-2" id="text-sec:appendix:fadc">
<p>
This appendix contains a few extra figures about the FADC
signals. Sec. <a href="./fadc.html#sec:appendix:fadc:rise_fall">30.1</a> contains additional figures 
– similar to fig. <a href="#fig:background:fadc_rise_time">70</a> used in the main
thesis – about the distribution of rise and fall
times. Sec. <a href="./fadc.html#sec:appendix:background:fadc">30.2</a> contains more specifics
related to the FADC veto. In the context of the FADC veto in the main
body the expected cluster size is mentioned, which is supported by a
figure in sec. <a href="./fadc.html#sec:appendix:fadc_veto_empirical_cluster_length">30.4</a>.
</p>
</div>

<div class="outline-3" id="outline-container-sec:appendix:fadc:rise_fall">
<h3 id="sec:appendix:fadc:rise_fall"><span class="section-number-3">30.1.</span> FADC rise and fall time</h3>
<div class="outline-text-3" id="text-sec:appendix:fadc:rise_fall">
<p>
These figures show a few extra figures of the FADC signal rise and
fall times comparing the \cefe calibration data with background data,
for Run-2 and Run-3 of the CAST data taking campaign. In the Run-2
figures more variation is visible, due to the different FADC amplifier
settings. These are similar (and include)
fig. <a href="#fig:background:fadc_rise_time">70</a> shown in the main body. See in
particular figures
<a href="#fig:background:fadc_rise_time_run2_different_settings">5</a> and
<a href="#fig:background:fadc_fall_time_run2_different_settings">6</a> for the impact
of the rise and fall time based on the different settings. The fall
time figures show that the difference between signal and background is
not very pronounced. This is expected, as the fall times are dominated
by the resistor-capacitor behavior of the circuit.
</p>


<figure id="fig:background:fadc_rise_time_run2">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_riseTime_kde_signal_vs_background_run2.svg" class="org-svg" alt="fadc_riseTime_kde_signal_vs_background_run2.svg" />

<figcaption>Figure 1: <span class="figure-number">Figure 180: </span>KDE of the rise time of the FADC signals in the \cefe and background data of the CAST Run-2 dataset. The X-ray data is a single peak with a mean of about \(\SI{70}{ns}\) while the background distribution is extremely wide, motivating a veto based on this data.</figcaption>
</figure>


<figure id="fig:appendix:fadc_rise_time_run3">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_riseTime_kde_signal_vs_background_run3.svg" class="org-svg" alt="fadc_riseTime_kde_signal_vs_background_run3.svg" />

<figcaption>Figure 2: <span class="figure-number">Figure 181: </span>KDE of the rise time of the FADC signals in the \cefe and background data of the CAST Run-3 dataset. The X-ray data is a single peak with a mean of about \(\SI{55}{ns}\) while the background distribution is extremely wide, motivating a veto based on this data.</figcaption>
</figure>


<figure id="fig:background:fadc_fall_time_run2">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_fallTime_kde_signal_vs_background_run2.svg" class="org-svg" alt="fadc_fallTime_kde_signal_vs_background_run2.svg" />

<figcaption>Figure 3: <span class="figure-number">Figure 182: </span>KDE of the rise time of the FADC signals in the \cefe and background data of the CAST Run-2 dataset. Difference in the two signal types is negligible. Multi-peak structure is due to different FADC settings, see fig. <a href="#fig:background:fadc_rise_time_run2_different_settings">5</a>.</figcaption>
</figure>


<figure id="fig:background:fadc_rise_time_run3">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_fallTime_kde_signal_vs_background_run3.svg" class="org-svg" alt="fadc_fallTime_kde_signal_vs_background_run3.svg" />

<figcaption>Figure 4: <span class="figure-number">Figure 183: </span>KDE of the fall time of the FADC signals in the \cefe and background data of the CAST Run-3 dataset. Difference in the two signal types is negligible.</figcaption>
</figure>


<figure id="fig:background:fadc_rise_time_run2_different_settings">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_riseTime_kde_signal_vs_background_different_fadc_amp_settings_run2.svg" class="org-svg" alt="fadc_riseTime_kde_signal_vs_background_different_fadc_amp_settings_run2.svg" />

<figcaption>Figure 5: <span class="figure-number">Figure 184: </span>KDE of the rise time of the FADC signals in the \cefe data of Run-2 split by the different FADC settings.</figcaption>
</figure>


<figure id="fig:background:fadc_fall_time_run2_different_settings">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_fallTime_kde_signal_vs_background_different_fadc_amp_settings_run2.svg" class="org-svg" alt="fadc_fallTime_kde_signal_vs_background_different_fadc_amp_settings_run2.svg" />

<figcaption>Figure 6: <span class="figure-number">Figure 185: </span>KDE of the fall time of the FADC signals in the \cefe data of Run-2 split by the different FADC settings. Impact on the fall time is more pronounced than on the rise time above.</figcaption>
</figure>

<p>
\clearpage
</p>
</div>
<div class="outline-4" id="outline-container-org31a1289">
<h4 id="org31a1289"><span class="section-number-4">30.1.1.</span> Generate plots for signal and background comparison   <span class="tag">  <span class="extended">extended</span></span></h4>
<div class="outline-text-4" id="text-30-1-1">
<p>
These plots are generated using <code>plotFadc</code> in
sec. <a href="./background.html#sec:background:fadc_veto:gen_signal_back_fadc_plots">12.5.2.6</a>.
</p>
</div>
</div>
</div>



<div class="outline-3" id="outline-container-sec:appendix:background:fadc">
<h3 id="sec:appendix:background:fadc"><span class="section-number-3">30.2.</span> FADC veto</h3>
<div class="outline-text-3" id="text-sec:appendix:background:fadc">
<p>
Only briefly mentioned in sec. <a href="./background.html#sec:background:fadc_veto">12.5.2</a> is the
addition of a cut on the skewness of the FADC signal, namely a
skewness \(&lt; -0.4\). Fig. <a href="#fig:appendix:fadc_veto:rise_skewness_run2">7</a>
shows the FADC signal rise times of all events in Run-2 and fig. <a href="#fig:appendix:fadc_veto:rise_skewness_run3">8</a>
for Run-3 against the skewness of the signal (i.e. a measure of how
one sided the signal is due to the negative from baseline shape of a
single FADC pulse). The color scale indicates whether the event is
considered &apos;noisy&apos; by our noise filter.
</p>

<p>
We can see the majority of all noise events above skewness values of
\(\geq 0.4\), roughly. There are pockets of non-noisy events above this
skewness value, in particular rise times of \(\numrange{180}{210}\) and
skewness \(\numrange{-0.7}{0.3}\) in Run-2. Events in this range were
inspected by eye (see extended thesis). They contain other noisy
events not registered by the noise filter and certain types of multi
cluster events resulting in peculiar shapes.
</p>

<p>
Finally, fig. <a href="#fig:appendix:fadc_veto:fadc_sig_back_efficiency">9</a> shows
the achievable signal efficiencies against background suppression as a
function of the rise time. In this case only the upper range is cut
(in practice the cut is symmetric on lower and upper end). This
illustrates the efficiency of the FADC veto without any additional
detector parts. At our used \(\SI{99}{\%}\) upper range cut the
background is suppressed to about \(\SI{60}{\%}\) of the full background
in the energy range of the \cefe photopeak.
</p>


<figure id="fig:appendix:fadc_veto:rise_skewness_run2">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_risetime_skewness_run2.svg" class="org-svg" alt="fadc_risetime_skewness_run2.svg" />

<figcaption>Figure 7: <span class="figure-number">Figure 186: </span>Scatter plot of all FADC events in Run-2 of the rise time of each event against the skewness. Colorcoded is whether each event is considered noisy by our noise filter.</figcaption>
</figure>


<figure id="fig:appendix:fadc_veto:rise_skewness_run3">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_risetime_skewness_run3.svg" class="org-svg" alt="fadc_risetime_skewness_run3.svg" />

<figcaption>Figure 8: <span class="figure-number">Figure 187: </span>Scatter plot of all FADC events in Run-3 of the rise time of each event against the skewness. Colorcoded is whether each event is considered noisy by our noise filter.</figcaption>
</figure>


<figure id="fig:appendix:fadc_veto:fadc_sig_back_efficiency">
<img src="./figs/home/basti/phd/Figs/FADC/fadc_rise_time_efficiencies_run3.svg" class="org-svg" alt="fadc_rise_time_efficiencies_run3.svg" />

<figcaption>Figure 9: <span class="figure-number">Figure 188: </span>Signal efficency achievable using only the FADC veto for \cefe calibration data by cutting on the rise time (only the upper end) compared to the corresponding background suppression (for Run-3 data).</figcaption>
</figure>

<p>
\clearpage
</p>
</div>
</div>
<div class="outline-3" id="outline-container-org517ef50">
<h3 id="org517ef50"><span class="section-number-3">30.3.</span> Generate plot of rise time vs skewness   <span class="tag">  <span class="extended">extended</span></span></h3>
<div class="outline-text-3" id="text-30-3">
<p>
The code here originates from:
<a href="./../org/Doc/StatusAndProgress.html">./../org/Doc/StatusAndProgress.html</a>
</p>

<p>
That section also contains the commands and studies of the
aforementioned regions of non noisy events in &apos;larger than veto&apos;
skewness values at low rise times.
</p>

<div class="org-src-container">
<pre class="src src-nim"><span style="color: #F92672;">import</span> nimhdf5, ggplotnim
<span style="color: #F92672;">import</span> std / <span style="color: #AE81FF;">[</span>strutils, os, sequtils, stats, strformat<span style="color: #AE81FF;">]</span>
<span style="color: #F92672;">import</span> ingrid / <span style="color: #AE81FF;">[</span>tos_helpers, fadc_helpers, ingrid_types, fadc_analysis<span style="color: #AE81FF;">]</span>

<span style="color: #F92672;">proc</span> <span style="color: #A6E22E;">getFadcSkewness</span><span style="color: #AE81FF;">(</span>h5f: <span style="color: #66D9EF;">H5File</span>, run: <span style="color: #66D9EF;">int</span><span style="color: #AE81FF;">)</span>: <span style="color: #66D9EF;">DataFrame</span> =
  <span style="color: #F92672;">let</span> <span style="color: #FD971F;">fadcRun </span>= readRecoFadcRun<span style="color: #AE81FF;">(</span>h5f, run<span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">let</span> <span style="color: #FD971F;">recoFadc </span>= readRecoFadc<span style="color: #AE81FF;">(</span>h5f, run<span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">let</span> <span style="color: #FD971F;">num </span>= fadcRun.eventNumber.<span style="color: #F92672;">len</span>
  <span style="color: #F92672;">var</span> <span style="color: #FD971F;">skews </span>= newSeqOfCap<span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">float</span><span style="color: #AE81FF;">](</span>num<span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">for</span> idx <span style="color: #F92672;">in</span> <span style="font-style: italic;">0</span> ..&lt; fadcRun.eventNumber.<span style="color: #F92672;">len</span>:
    skews.<span style="color: #F92672;">add</span> fadcRun.fadcData<span style="color: #AE81FF;">[</span>idx, _<span style="color: #AE81FF;">]</span>.squeeze.toSeq1D.skewness<span style="color: #AE81FF;">()</span>
  <span style="color: #FD971F;">result</span> = toDf<span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">{</span>skews, <span style="color: #E6DB74;">&quot;riseTime&quot;</span> : recoFadc.riseTime.asType<span style="color: #A6E22E;">(</span><span style="color: #66D9EF;">float</span><span style="color: #A6E22E;">)</span>, <span style="color: #E6DB74;">&quot;noisy&quot;</span> : recoFadc.noisy<span style="color: #66D9EF;">}</span><span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">echo</span> <span style="color: #FD971F;">result</span>

<span style="color: #F92672;">proc</span> <span style="color: #A6E22E;">main</span><span style="color: #AE81FF;">(</span>fname: <span style="color: #66D9EF;">string</span>,
          outpath = <span style="color: #E6DB74;">&quot;/tmp/&quot;</span>,
          suffix = <span style="color: #E6DB74;">&quot;&quot;</span><span style="color: #AE81FF;">)</span> =
  <span style="color: #F92672;">let</span> <span style="color: #FD971F;">tmpFile </span>= <span style="color: #E6DB74;">&quot;/tmp/&quot;</span> &amp; fname.extractFilename.replace<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">&quot;.h5&quot;</span>, <span style="color: #E6DB74;">&quot;.csv&quot;</span><span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">var</span> <span style="color: #FD971F;">df </span>= newDataFrame<span style="color: #AE81FF;">()</span>
  <span style="color: #F92672;">if</span> <span style="color: #F92672;">not</span> fileExists tmpFile:
    <span style="color: #F92672;">var</span> <span style="color: #FD971F;">h5f </span>= <span style="color: #66D9EF;">H5open</span><span style="color: #AE81FF;">(</span>fname, <span style="color: #E6DB74;">&quot;r&quot;</span><span style="color: #AE81FF;">)</span>
    <span style="color: #F92672;">let</span> <span style="color: #FD971F;">fileInfo </span>= h5f.getFileInfo<span style="color: #AE81FF;">()</span>
    <span style="color: #F92672;">var</span> <span style="color: #FD971F;">dfs </span>= <span style="color: #F92672;">newSeq</span><span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">DataFrame</span><span style="color: #AE81FF;">]()</span>
    <span style="color: #F92672;">for</span> run <span style="color: #F92672;">in</span> fileInfo.runs:
      <span style="color: #F92672;">echo</span> <span style="color: #E6DB74;">&quot;Run = &quot;</span>, run
      <span style="color: #F92672;">let</span> <span style="color: #FD971F;">fadcGroup </span>= fadcRecoPath<span style="color: #AE81FF;">(</span>run<span style="color: #AE81FF;">)</span>
      <span style="color: #F92672;">if</span> fadcGroup <span style="color: #F92672;">in</span> h5f: <span style="color: #75715E;"># </span><span style="color: #75715E;">there were some runs at end of data taking without any FADC (298, 299)</span>
        dfs.<span style="color: #F92672;">add</span> h5f.getFadcSkewness<span style="color: #AE81FF;">(</span>run<span style="color: #AE81FF;">)</span>
    df = assignStack<span style="color: #AE81FF;">(</span>dfs<span style="color: #AE81FF;">)</span>
    df.writeCsv<span style="color: #AE81FF;">(</span>tmpFile<span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">else</span>:
    df = readCsv<span style="color: #AE81FF;">(</span>tmpFile<span style="color: #AE81FF;">)</span>
  <span style="color: #F92672;">echo</span> df
  df = df.mutate<span style="color: #AE81FF;">(</span>f<span style="color: #66D9EF;">{</span><span style="color: #66D9EF;">int</span> -&gt; <span style="color: #66D9EF;">bool</span>: <span style="color: #E6DB74;">&quot;noisy&quot;</span> ~ <span style="color: #A6E22E;">(</span><span style="color: #F92672;">if</span> `noisy` == <span style="font-style: italic;">0</span>: <span style="color: #AE81FF;">false</span> <span style="color: #F92672;">else</span>: <span style="color: #AE81FF;">true</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">}</span><span style="color: #AE81FF;">)</span>
  
  ggplot<span style="color: #AE81FF;">(</span>df, aes<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">&quot;skews&quot;</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span> +
    geom_density<span style="color: #AE81FF;">()</span> +
    ggsave<span style="color: #AE81FF;">(</span>&amp;<span style="color: #E6DB74;">&quot;{outpath}/fadc_skewness_kde_{suffix}.pdf&quot;</span><span style="color: #AE81FF;">)</span>

  ggplot<span style="color: #AE81FF;">(</span>df, aes<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">&quot;skews&quot;</span>, <span style="color: #E6DB74;">&quot;riseTime&quot;</span>, color = <span style="color: #E6DB74;">&quot;noisy&quot;</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span> +
    <span style="color: #75715E;">#</span><span style="color: #75715E;">geom_point(size = 1.0, alpha = 0.2) +</span>
    geom_point<span style="color: #AE81FF;">(</span>size = <span style="font-style: italic;">0</span>.<span style="font-style: italic;">5</span>, alpha = <span style="font-style: italic;">0</span>.<span style="font-style: italic;">75</span><span style="color: #AE81FF;">)</span> +
    xlab<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">&quot;Skewness&quot;</span><span style="color: #AE81FF;">)</span> + ylab<span style="color: #AE81FF;">(</span><span style="color: #E6DB74;">&quot;riseTime [ns]&quot;</span><span style="color: #AE81FF;">)</span> + 
    themeLatex<span style="color: #AE81FF;">(</span>fWidth = <span style="font-style: italic;">0</span>.<span style="font-style: italic;">9</span>, width = <span style="font-style: italic;">600</span>, baseTheme = singlePlot<span style="color: #AE81FF;">)</span> + 
    ggsave<span style="color: #AE81FF;">(</span>&amp;<span style="color: #E6DB74;">&quot;{outpath}/fadc_risetime_skewness_{suffix}.pdf&quot;</span>, dataAsBitmap = <span style="color: #AE81FF;">true</span><span style="color: #AE81FF;">)</span>
    
<span style="color: #F92672;">when</span> <span style="color: #AE81FF;">isMainModule</span>:
  <span style="color: #F92672;">import</span> cligen
  dispatch main
</pre>
</div>

<p>
Run-2:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #FD971F;">WRITE_PLOT_CSV</span>=true <span style="color: #E6DB74; font-weight: bold;">\</span>
    ./fadc_data_skewness <span style="color: #E6DB74; font-weight: bold;">\</span>
    -f ~/CastData/data/DataRuns2017_Reco.h5 <span style="color: #E6DB74; font-weight: bold;">\</span>
    --outpath ~/phd/Figs/FADC/ <span style="color: #E6DB74; font-weight: bold;">\</span>
    --suffix <span style="color: #E6DB74;">&quot;run2&quot;</span>
</pre>
</div>
<p>
and for sanity, Run-3:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #FD971F;">WRITE_PLOT_CSV</span>=true <span style="color: #E6DB74; font-weight: bold;">\</span>
    ./fadc_data_skewness <span style="color: #E6DB74; font-weight: bold;">\</span>
    -f ~/CastData/data/DataRuns2018_Reco.h5 <span style="color: #E6DB74; font-weight: bold;">\</span>
    --outpath ~/phd/Figs/FADC/ <span style="color: #E6DB74; font-weight: bold;">\</span>
    --suffix <span style="color: #E6DB74;">&quot;run3&quot;</span>
</pre>
</div>
</div>
</div>



<div class="outline-3" id="outline-container-sec:appendix:fadc_veto_empirical_cluster_length">
<h3 id="sec:appendix:fadc_veto_empirical_cluster_length"><span class="section-number-3">30.4.</span> Expected cluster size</h3>
<div class="outline-text-3" id="text-sec:appendix:fadc_veto_empirical_cluster_length">
<p>
While not strictly speaking FADC data, the expected size of clusters
was mentioned in sec. <a href="./background.html#sec:background:fadc_veto">12.5.2</a> to be about
\(\SI{6}{mm}\) in length for \cefe calibration data. This is shown in
fig. <a href="#fig:appendix:empirical_cluster_lengths">10</a>. 
</p>


<figure id="fig:appendix:empirical_cluster_lengths">
<img src="./figs/home/basti/phd/Figs/expectedClusterSize/length_run83_187_chip3_0.04833333333333333_binSize_binRange-0.0_14.5_region_crSilver_rmsTransverse_0.1_1.1_applyAll_true.svg" class="org-svg" alt="length_run83_187_chip3_0.04833333333333333_binSize_binRange-0.0_14.5_region_crSilver_rmsTransverse_0.1_1.1_applyAll_true.svg" />

<figcaption>Figure 10: <span class="figure-number">Figure 189: </span>Cluster lengths in millimeter of \cefe calibration data during the Run-2 data taking campaign. These \(\SI{5.9}{keV}\) clusters peak at around \(\SI{5.5}{mm}\) in length with significant drop in statistics from \(\SI{6}{mm}\).</figcaption>
</figure>
</div>


<div class="outline-4" id="outline-container-org2976672">
<h4 id="org2976672"><span class="section-number-4">30.4.1.</span> Generate cluster length plot   <span class="tag">  <span class="extended">extended</span></span></h4>
<div class="outline-text-4" id="text-30-4-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #FD971F;">WRITE_PLOT_CSV</span>=true <span style="color: #FD971F;">LINE_BREAK</span>=true <span style="color: #FD971F;">T_MARGIN</span>=1.75 <span style="color: #FD971F;">USE_TEX</span>=true <span style="color: #FD971F;">WIDTH</span>=600 <span style="color: #FD971F;">HEIGHT</span>=420 <span style="color: #E6DB74; font-weight: bold;">\</span>
   plotData --h5file ~/CastData/data/CalibrationRuns2017_Reco.h5 <span style="color: #E6DB74; font-weight: bold;">\</span>
            --runType rtCalibration <span style="color: #E6DB74; font-weight: bold;">\</span>
            --chips 3 <span style="color: #E6DB74; font-weight: bold;">\</span>
            --config ~/CastData/ExternCode/TimepixAnalysis/Plotting/karaPlot/config.toml <span style="color: #E6DB74; font-weight: bold;">\</span>
            --ingrid <span style="color: #E6DB74; font-weight: bold;">\</span>
            --cuts <span style="color: #E6DB74;">&apos;(&quot;rmsTransverse&quot;, 0.1, 1.1)&apos;</span> <span style="color: #E6DB74; font-weight: bold;">\</span>
            --applyAllCuts <span style="color: #E6DB74; font-weight: bold;">\</span>
            --region crSilver <span style="color: #E6DB74; font-weight: bold;">\</span>
            --plotPath ~/phd/Figs/expectedClusterSize/
</pre>
</div>
</div>
</div>
</div>
</div>


<div class="hint-message">Click on any heading marked '<span class="extended">extended</span>' to open it</div>
</div>
</body>
</html>
